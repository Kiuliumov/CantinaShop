{% extends "base.html" %}
{% load static %}

{% block content %}
    <div class="max-w-screen-xl mx-auto px-6 md:px-10 lg:px-16 py-12 bg-gray-800 text-white rounded-2xl shadow-xl">
        <div class="flex flex-col md:flex-row gap-12 items-stretch">
            <div class="flex-1">
                {% include "products/partials/details/_product_image.html" %}
            </div>

            <div class="flex-1 flex flex-col justify-between">
                {% include "products/partials/details/_product_info.html" %}
                {% include "products/partials/details/_product_actions.html" %}
            </div>
        </div>

        {% if request.user.is_authenticated %}
            {% include "products/partials/details/_rate_product.html" %}
        {% endif %}

        {% include "products/partials/details/_comments_section.html" %}

        {% include 'partials/pop-ups/confirm_delete.html' %}
        {% include 'partials/pop-ups/cart-pop-up.html' %}
        {% include 'partials/pop-ups/create-popup.html' %}
        {% include 'partials/pop-ups/update-success.html' %}
    </div>
{% endblock %}

{% block script %}
    {{ block.super }}
    <script src="{% static 'js/cart/toggleEdit.js' %}"></script>
    <script src="{% static 'js/boxes/confirmDelete.js' %}"></script>
    <script src="{% static 'js/utils/quantityButtonPlus.js' %}"></script>
    {% if not product.is_available %}
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const btn = document.querySelector(".order-link");
                if (btn) {
                    btn.href = "#";
                    btn.classList.add("bg-gray-400", "cursor-not-allowed", "opacity-60", "pointer-events-none");
                    btn.classList.remove("bg-indigo-600", "hover:bg-indigo-700");
                    btn.setAttribute("aria-disabled", "true");
                    btn.innerHTML = '<i class="fas fa-shopping-cart mr-2"></i> Unavailable';
                }
            });
        </script>
    {% endif %}
    {% if request.user.is_authenticated %}
        <script src="{% static 'js/cart/starRating.js' %}"></script>
        <script src="{% static 'js/boxes/orderPopUp.js' %}"></script>
        <script src="{% static 'js/cart/orderCookieQuantity.js' %}"></script>
        <script src="{% static 'js/boxes/createPopUp.js' %}"></script>
        <script src="{% static 'js/boxes/editSuccess.js' %}"></script>
    {% endif %}
{% endblock %}
